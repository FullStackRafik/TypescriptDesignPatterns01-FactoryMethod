{"version":3,"sources":["webparts/factoryMethod/components/FactoryMethod.tsx"],"names":[],"mappings":";;;;;;;;;;;;AAAA,iBAAiB;AACjB,6BAA+B;AAgB/B,qDAAmD;AAEnD,sEAMgD;AAIhD,YAAY;AAGZ;IAA2C,iCAAyD;IAClG,uBAAY,KAA0B,EAAE,KAAU;QAAlD,YACE,kBAAM,KAAK,CAAC,SAEb;QA2GD,4BAA4B;QACpB,0BAAoB,GAAG,UAAC,SAAoD,IAAK,OAAA,CACrF;YACI,oBAAC,yBAAW,IACV,KAAK,EAAG,SAAS,CAAC,KAAK,EACvB,OAAO,EAAG,SAAS,CAAC,OAAO,EAC3B,MAAM,EAAC,KAAK,EACZ,UAAU,EAAG,mCAAqB,CAAC,YAAY,EAC/C,8BAA8B,EAAG,IAAI,EACrC,OAAO,EAAG,IAAI,GACF,CACZ,CACT,EAXwF,CAWxF,CAAA;QAxHC,KAAI,CAAC,eAAe,EAAE,CAAC;;IACzB,CAAC;IAGD,mGAAmG;IAEnG,kCAAkC;IAElC,oEAAoE;IACpE,mEAAmE;IACnE,4DAA4D;IAC5D,6DAA6D;IAC7D,oEAAoE;IACpE,+EAA+E;IACxE,8BAAM,GAAb;QACE,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;YACxB,wCAAwC;YACxC,MAAM,CAAC,wDAA8B,CAAC;QACxC,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,MAAM,CAAA,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACzB,KAAK,aAAa;oBAChB,2CAA2C;oBAC3C,MAAM,CAAC,oBAAC,IAAI,CAAC,oBAAoB,IAAC,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,2BAA2B,CAAC,KAAK,EAAE,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,GAAI,CAAC;gBACzH,KAAK,MAAM;oBACT,2CAA2C;oBAC3C,MAAM,CAAC,oBAAC,IAAI,CAAC,oBAAoB,IAAC,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,wBAAwB,CAAC,KAAK,EAAE,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC;gBACrH,KAAK,eAAe;oBAClB,2CAA2C;oBAC3C,MAAM,CAAC,oBAAC,IAAI,CAAC,oBAAoB,IAAC,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,gCAAgC,CAAC,KAAK,EAAE,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC;gBAC7H,KAAK,WAAW;oBACd,2CAA2C;oBAC3C,MAAM,CAAC,oBAAC,IAAI,CAAC,oBAAoB,IAAC,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,6BAA6B,CAAC,KAAK,EAAE,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC;gBAC1H;oBACE,MAAM,CAAC,IAAI,CAAC;YAClB,CAAC;QACH,CAAC;IACH,CAAC;IAEM,yCAAiB,GAAxB,UAAyB,KAAU,EAAE,IAAS;QAC5C,sBAAsB;QACtB,IAAI,CAAC,QAAQ,CAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC;QAClC,2DAA2D;QAC3D,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QACnB,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IACpB,CAAC;IAID,kIAAkI;IAClI,4GAA4G;IAC5G,kIAAkI;IAClI,yHAAyH;IACzH,8HAA8H;IAC9H,oIAAoI;IACpI,gHAAgH;IACxG,yCAAiB,GAAxB;QACC,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC3D,IAAI,CAAC,qBAAqB,EAAE,CAAC;IAC/B,CAAC;IAED,YAAY;IAEZ,yFAAyF;IACzF,wFAAwF;IACxF,sDAAsD;IACtD,6GAA6G;IAC7G,wCAAwC;IACxC,+GAA+G;IAC/G,sDAAsD;IACtD,+EAA+E;IAC/E,wGAAwG;IACxG,iDAAiD;IACjD,gFAAgF;IACzE,iDAAyB,GAAhC,UAAiC,SAA8B;QAC7D,EAAE,CAAA,CAAC,SAAS,CAAC,QAAQ,KAAK,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;YAC9C,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAC/B,CAAC;IACH,CAAC;IAED,YAAY;IAEZ,yBAAyB;IACjB,yCAAiB,GAAzB;QACE,IAAI,CAAC,KAAK,CAAC,sBAAsB,EAAE,CAAC;IACtC,CAAC;IAEM,uCAAe,GAAtB;QACE,IAAI,CAAC,KAAK,GAAG;YACX,QAAQ,EAAE,KAAK;YACf,MAAM,EAAE,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC;kBACtC,8CAA8C;kBAC9C,OAAO;YACX,OAAO,EAAC,EAAE;YACV,2BAA2B,EAAC;gBAC1B,KAAK,EAAC,EAAE;aACT;YACD,wBAAwB,EAAC;gBACvB,KAAK,EAAC,EAAE;aACT;YACD,6BAA6B,EAAC;gBAC5B,KAAK,EAAC,EAAE;aACT;YACD,gCAAgC,EAAC;gBAC/B,KAAK,EAAC,EAAE;aACT;SACF,CAAC;IACJ,CAAC;IAgBD,qEAAqE;IAC7D,6CAAqB,GAA7B;QAAA,iBAoCC;QAnCC,IAAI,CAAC,QAAQ,CAAC;YACZ,MAAM,EAAE,sBAAsB;SAC/B,CAAC,CAAC;QAEH,IAAM,OAAO,GAAoB,IAAI,iCAAe,EAAE,CAAC;QACvD,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,YAAY,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC;aACjF,IAAI,CAAC,UAAC,KAAY;YAEjB,IAAI,OAAO,GAAQ,IAAI,CAAC;YACxB,MAAM,CAAA,CAAC,KAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACzB,KAAK,aAAa;oBACd,OAAO,GAAG,KAAoB,CAAC;oBAC/B,KAAK,CAAC;gBACV,KAAK,MAAM;oBACP,OAAO,GAAG,KAAwB,CAAC;oBACnC,KAAK,CAAC;gBACV,KAAK,eAAe;oBAChB,OAAO,GAAG,KAAgC,CAAC;oBAC3C,KAAK,CAAC;gBACV,KAAK,WAAW;oBACZ,OAAO,GAAG,KAA6B,CAAC;oBACxC,KAAK,CAAC;YACd,CAAC;YAED,IAAM,OAAO,GAAW,KAAI,CAAC,KAAK,CAAC,QAAQ,KAAK,aAAa,GAAG,EAAE,GAAG,KAAI,CAAC,KAAK,CAAC,QAAQ,CAAC;YACvF,wEAAwE;YACxE,6BAA6B;YAC7B,KAAI,CAAC,QAAQ;oBACX,MAAM,EAAE,yBAAuB,KAAK,CAAC,MAAM,WAAQ;;gBACnD,GAAC,SAAS,GAAG,OAAO,GAAG,eAAe,IAAI;oBACxC,OAAO,SAAA;iBACR;gBACD,UAAO,GAAE,0BAAY,CAAC,OAAO,CAAC;oBAC9B,CAAC;;QACP,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,yCAAiB,GAAzB,UAA0B,KAA0B;QAClD,MAAM,CAAC,KAAK,CAAC,QAAQ,KAAK,SAAS;YACjC,KAAK,CAAC,QAAQ,KAAK,IAAI;YACvB,KAAK,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC,CAAC;IAChC,CAAC;IAGH,oBAAC;AAAD,CA3KA,AA2KC,CA3K0C,KAAK,CAAC,SAAS,GA2KzD","file":"webparts/factoryMethod/components/FactoryMethod.js","sourcesContent":["//#region Imports\r\nimport * as React from \"react\";\r\nimport styles from \"./FactoryMethod.module.scss\";\r\nimport  { IFactoryMethodProps } from \"./IFactoryMethodProps\";\r\nimport {\r\n  IDetailsGenericListItemState,\r\n  IDetailsNewsListItemState,\r\n  IDetailsDirectoryListItemState,\r\n  IDetailsAnnouncementListItemState,\r\n  IFactoryMethodState\r\n} from \"./IFactoryMethodState\";\r\nimport { IListItem } from \"./models/IListItem\";\r\nimport { IAnnouncementListItem } from \"./models/IAnnouncementListItem\";\r\nimport { INewsListItem } from \"./models/INewsListItem\";\r\nimport { IDirectoryListItem } from \"./models/IDirectoryListItem\";\r\nimport { escape } from \"@microsoft/sp-lodash-subset\";\r\nimport { SPHttpClient, SPHttpClientResponse } from \"@microsoft/sp-http\";\r\nimport { ListItemFactory} from \"./ListItemFactory\";\r\nimport { TextField } from \"office-ui-fabric-react/lib/TextField\";\r\nimport {\r\n  DetailsList,\r\n  DetailsListLayoutMode,\r\n  Selection,\r\n  buildColumns,\r\n  IColumn\r\n} from \"office-ui-fabric-react/lib/DetailsList\";\r\nimport { MarqueeSelection } from \"office-ui-fabric-react/lib/MarqueeSelection\";\r\nimport { autobind } from \"office-ui-fabric-react/lib/Utilities\";\r\nimport PropTypes from \"prop-types\";\r\n//#endregion\r\n\r\n\r\nexport default class FactoryMethod extends React.Component<IFactoryMethodProps, IFactoryMethodState> {\r\n  constructor(props: IFactoryMethodProps, state: any) {\r\n    super(props);\r\n    this.setInitialState();\r\n  }\r\n\r\n\r\n  // lifecycle help here: https://staminaloops.github.io/undefinedisnotafunction/understanding-react/\r\n\r\n  //#region Mouting events lifecycle\r\n\r\n  // the data returned from render is neither a string nor a DOM node.\r\n  // it's a lightweight description of what the DOM should look like.\r\n  // inspects this.state and this.props and create the markup.\r\n  // when your data changes, the render method is called again.\r\n  // react diff the return value from the previous call to render with\r\n  // the new one, and generate a minimal set of changes to be applied to the DOM.\r\n  public render(): React.ReactElement<IFactoryMethodProps> {\r\n    if (this.state.hasError) {\r\n      // you can render any custom fallback UI\r\n      return <h1>Something went wrong.</h1>;\r\n    } else {\r\n      switch(this.props.listName) {\r\n          case \"GenericList\":\r\n            // tslint:disable-next-line:max-line-length\r\n            return <this.ListMarqueeSelection items={this.state.DetailsGenericListItemState.items} columns={this.state.columns} />;\r\n          case \"News\":\r\n            // tslint:disable-next-line:max-line-length\r\n            return <this.ListMarqueeSelection items={this.state.DetailsNewsListItemState.items} columns={this.state.columns}/>;\r\n          case \"Announcements\":\r\n            // tslint:disable-next-line:max-line-length\r\n            return <this.ListMarqueeSelection items={this.state.DetailsAnnouncementListItemState.items} columns={this.state.columns}/>;\r\n          case \"Directory\":\r\n            // tslint:disable-next-line:max-line-length\r\n            return <this.ListMarqueeSelection items={this.state.DetailsDirectoryListItemState.items} columns={this.state.columns}/>;\r\n          default:\r\n            return null;\r\n      }\r\n    }\r\n  }\r\n\r\n  public componentDidCatch(error: any, info: any): void {\r\n    // display fallback UI\r\n    this.setState({ hasError: true });\r\n    // you can also log the error to an error reporting service\r\n    console.log(error);\r\n    console.log(info);\r\n  }\r\n\r\n\r\n\r\n  // componentDidMount() is invoked immediately after a component is mounted. Initialization that requires DOM nodes should go here.\r\n  // if you need to load data from a remote endpoint, this is a good place to instantiate the network request.\r\n  // this method is a good place to set up any subscriptions. If you do that, don’t forget to unsubscribe in componentWillUnmount().\r\n  // calling setState() in this method will trigger an extra rendering, but it is guaranteed to flush during the same tick.\r\n  // this guarantees that even though the render() will be called twice in this case, the user won’t see the intermediate state.\r\n  // use this pattern with caution because it often causes performance issues. It can, however, be necessary for cases like modals and\r\n  // tooltips when you need to measure a DOM node before rendering something that depends on its size or position.\r\n   public componentDidMount(): void {\r\n    this._configureWebPart = this._configureWebPart.bind(this);\r\n    this.readItemsAndSetStatus();\r\n  }\r\n\r\n  //#endregion\r\n\r\n  //#region Props changes lifecycle events (after a property changes from parent component)\r\n  // componentWillReceiveProps() is invoked before a mounted component receives new props.\r\n  // if you need to update the state in response to prop\r\n  // changes (for example, to reset it), you may compare this.props and nextProps and perform state transitions\r\n  // using this.setState() in this method.\r\n  // note that React may call this method even if the props have not changed, so make sure to compare the current\r\n  // and next values if you only want to handle changes.\r\n  // this may occur when the parent component causes your component to re-render.\r\n  // react doesn’t call componentWillReceiveProps() with initial props during mounting. It only calls this\r\n  // method if some of component’s props may update\r\n  // calling this.setState() generally doesn’t trigger componentWillReceiveProps()\r\n  public componentWillReceiveProps(nextProps: IFactoryMethodProps): void {\r\n    if(nextProps.listName !== this.props.listName) {\r\n      this.readItemsAndSetStatus();\r\n    }\r\n  }\r\n\r\n  //#endregion\r\n\r\n  //#region private methods\r\n  private _configureWebPart(): void {\r\n    this.props.configureStartCallback();\r\n  }\r\n\r\n  public setInitialState(): void {\r\n    this.state = {\r\n      hasError: false,\r\n      status: this.listNotConfigured(this.props)\r\n        ? \"Please configure list in Web Part properties\"\r\n        : \"Ready\",\r\n      columns:[],\r\n      DetailsGenericListItemState:{\r\n        items:[]\r\n      },\r\n      DetailsNewsListItemState:{\r\n        items:[]\r\n      },\r\n      DetailsDirectoryListItemState:{\r\n        items:[]\r\n      },\r\n      DetailsAnnouncementListItemState:{\r\n        items:[]\r\n      },\r\n    };\r\n  }\r\n\r\n  // reusable inline component\r\n  private ListMarqueeSelection = (itemState: {columns: IColumn[], items: IListItem[] }) => (\r\n      <div>\r\n          <DetailsList\r\n            items={ itemState.items }\r\n            columns={ itemState.columns }\r\n            setKey=\"set\"\r\n            layoutMode={ DetailsListLayoutMode.fixedColumns }\r\n            selectionPreservedOnEmptyClick={ true }\r\n            compact={ true }>\r\n          </DetailsList>\r\n      </div>\r\n  )\r\n\r\n  // read items using factory method pattern and sets state accordingly\r\n  private readItemsAndSetStatus(): void {\r\n    this.setState({\r\n      status: \"Loading all items...\"\r\n    });\r\n\r\n    const factory: ListItemFactory = new ListItemFactory();\r\n    factory.getItems(this.props.spHttpClient, this.props.siteUrl, this.props.listName)\r\n    .then((items: any[]) => {\r\n\r\n      var myItems: any = null;\r\n      switch(this.props.listName) {\r\n          case \"GenericList\":\r\n              myItems = items as IListItem[];\r\n              break;\r\n          case \"News\":\r\n              myItems = items as INewsListItem[];\r\n              break;\r\n          case \"Announcements\":\r\n              myItems = items as IAnnouncementListItem[];\r\n              break;\r\n          case \"Directory\":\r\n              myItems = items as IDirectoryListItem[];\r\n              break;\r\n      }\r\n\r\n      const keyPart: string = this.props.listName === \"GenericList\" ? \"\" : this.props.listName;\r\n        // the explicit specification of the type argument `keyof {}` is bad and\r\n        // it should not be required.\r\n        this.setState<keyof {}>({\r\n          status: `Successfully loaded ${items.length} items`,\r\n          [\"Details\" + keyPart + \"ListItemState\"] : {\r\n            myItems\r\n          },\r\n          columns: buildColumns(myItems)\r\n        });\r\n    });\r\n  }\r\n\r\n  private listNotConfigured(props: IFactoryMethodProps): boolean {\r\n    return props.listName === undefined ||\r\n      props.listName === null ||\r\n      props.listName.length === 0;\r\n  }\r\n\r\n  //#endregion\r\n}\r\n\r\n\r\n"],"sourceRoot":"..\\..\\..\\..\\src"}